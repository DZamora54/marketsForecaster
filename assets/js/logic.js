const marketsData = [
  {
    name: "Albania",
    marketId: "albania",
    docMarket: "No",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Argentina",
    marketId: "argentina",
    docMarket: "No",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Australia",
    marketId: "australia",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Austria",
    marketId: "austriaa",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Bahrain",
    marketId: "bahrain",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Bangladesh",
    marketId: "bangladesh",
    docMarket: "Yes",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Belgium",
    marketId: "belgium",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Bermuda",
    marketId: "bermuda",
    docMarket: "No",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Bosnia",
    marketId: "bosnia",
    docMarket: "No",
    timeframeToOpen: 4,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Botswana",
    marketId: "botswana",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Brazil",
    marketId: "brazil",
    docMarket: "Yes",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Bulgaria",
    marketId: "bulgaria",
    docMarket: "No",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Canada",
    marketId: "canada",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Chile",
    marketId: "chile",
    docMarket: "Yes",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "China Connect",
    marketId: "chinaConnect",
    docMarket: "Yes",
    timeframeToOpen: 20,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "China Interbank Bond Connect (CIBM)",
    marketId: "chinaBondConnect",
    docMarket: "Yes",
    timeframeToOpen: 35,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "China A-share",
    marketId: "chinaA",
    docMarket: "180",
    timeframeToOpen: 180,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "China B-share Shanghai",
    marketId: "chinaBShanghai",
    docMarket: "Yes",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "China B-share Shenzhen",
    marketId: "chinaBShenzhen",
    docMarket: "Yes",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Clearstream",
    marketId: "clearstream",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Colombia",
    marketId: "colombia",
    docMarket: "Yes",
    timeframeToOpen: 12,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Costa Rica",
    marketId: "costaRica",
    docMarket: "No",
    timeframeToOpen: 4,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Croatia",
    marketId: "croatia",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Cyprus",
    marketId: "cyprus",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Czech Republic",
    marketId: "czechRepublic",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Denmark",
    marketId: "denmark",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Egypt",
    marketId: "egypt",
    docMarket: "Yes",
    timeframeToOpen: 6,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Estonia",
    marketId: "estonia",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Eswatini",
    marketId: "eswatini",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Euroclear",
    marketId: "euroclear",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Finland",
    marketId: "finland",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "France",
    marketId: "france",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Georgia, Republic of",
    marketId: "georgia",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Germany",
    marketId: "germany",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Ghana",
    marketId: "ghana",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Greece",
    marketId: "greece",
    docMarket: "Yes",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Hong Kong (HKD)",
    marketId: "hongKongHkd",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Hong Kong (CNY)",
    marketId: "hongKongCny",
    docMarket: "Yes",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Hungary",
    marketId: "hungary",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Iceland",
    marketId: "iceland",
    docMarket: "Yes",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "India - FDI",
    marketId: "indiaFpi",
    docMarket: "Yes",
    timeframeToOpen: 60,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "India - FPI",
    marketId: "indiaFpi",
    docMarket: "Yes",
    timeframeToOpen: 40,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Indonesia",
    marketId: "indonesia",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Ireland",
    marketId: "ireland",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Israel",
    marketId: "israel",
    docMarket: "No",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Italy",
    marketId: "italy",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Ivory Coast",
    marketId: "ivoryCoast",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Japan",
    marketId: "japan",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Japan JGB",
    marketId: "japanJgb",
    docMarket: "Yes",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Jordan",
    marketId: "jordan",
    docMarket: "No",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Kazakhstan",
    marketId: "kazakhstan",
    docMarket: "No",
    timeframeToOpen: 35,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Kenya",
    marketId: "kenya",
    docMarket: "No",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Korea",
    marketId: "korea",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Kuwait",
    marketId: "kuwait",
    docMarket: "No",
    timeframeToOpen: 20,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Latvia",
    marketId: "latvia",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Lithuania",
    marketId: "lithuania",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Luxembourg",
    marketId: "luxembourg",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Malawi",
    marketId: "malawi",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Malaysia-Local",
    marketId: "malaysiaLocal",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Malaysia-RENTAS",
    marketId: "malaysiaRentas",
    docMarket: "No",
    timeframeToOpen: 8,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Mauritius",
    marketId: "mauritius",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Mexico",
    marketId: "mexico",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Morocco",
    marketId: "morocco",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Namibia",
    marketId: "namibia",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Netherlands",
    marketId: "netherlands",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "New Zealand",
    marketId: "newZealand",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Nigeria",
    marketId: "nigeria",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Norway",
    marketId: "norway",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Oman",
    marketId: "oman",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Pakistan",
    marketId: "pakistan",
    docMarket: "Yes",
    timeframeToOpen: 21,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Panama",
    marketId: "panama",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Peru",
    marketId: "peru",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Philippines",
    marketId: "philippines",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Poland",
    marketId: "poland",
    docMarket: "No",
    timeframeToOpen: 3,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Portugal",
    marketId: "portugal",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Qatar",
    marketId: "qatar",
    docMarket: "Yes",
    timeframeToOpen: 10,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Romania",
    marketId: "romania",
    docMarket: "No",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Russia",
    marketId: "russia",
    docMarket: "Yes",
    timeframeToOpen: 10,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Saudi Arabia",
    marketId: "saudiArabia",
    docMarket: "Yes",
    timeframeToOpen: 8,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Serbia",
    marketId: "serbia",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Singapore",
    marketId: "singapore",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Slovak Republic",
    marketId: "slovakRepublic",
    docMarket: "Yes",
    timeframeToOpen: 4,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Slovenia",
    marketId: "slovenia",
    docMarket: "Yes",
    timeframeToOpen: 4,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "South Africa",
    marketId: "southAfrica",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Spain",
    marketId: "spain",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Sri Lanka",
    marketId: "sriLanka",
    docMarket: "Yes",
    timeframeToOpen: 45,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Srpska",
    marketId: "srpska",
    docMarket: "Yes",
    timeframeToOpen: 4,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Sweden",
    marketId: "sweden",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Switzerland",
    marketId: "switzerland",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Taiwan",
    marketId: "taiwan",
    docMarket: "Yes",
    timeframeToOpen: 10,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Tanzania",
    marketId: "tanzania",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Thailand",
    marketId: "thailand",
    docMarket: "Yes",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Tunisia",
    marketId: "tunisia",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Turkey",
    marketId: "turkey",
    docMarket: "Yes",
    timeframeToOpen: 10,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Uganda",
    marketId: "uganda",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Ukraine",
    marketId: "ukraine",
    docMarket: "No",
    timeframeToOpen: 14,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "United Arab Emirates / Abu Dhabi Exchange (ADX)",
    marketId: "uaeAdx",
    docMarket: "Yes",
    timeframeToOpen: 12,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "United Arab Emirates / Dubai Financial Market (DFM)",
    marketId: "uaeDfm",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "United Arab Emirates / Dubai Int'l Financial Center (DIFC)",
    marketId: "uaeDifc",
    docMarket: "Yes",
    timeframeToOpen: 7,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "United Kingdom",
    marketId: "unitedKingdom",
    docMarket: "No",
    timeframeToOpen: 2,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "United States",
    marketId: "unitedStates",
    docMarket: "No",
    timeframeToOpen: 1,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Uruguay",
    marketId: "uruguay",
    docMarket: "No",
    timeframeToOpen: 5,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
  {
    name: "Vietnam",
    marketId: "vietnam",
    docMarket: "Yes",
    timeframeToOpen: 45,
    requestedDay1: "No",
    requestedAsap: "No",
    openDate: "MMM DD YYYY",
  },
];

let launchDate;
let amlKycSubmitDate;
let amlKycCompleteDateTimeframe = 15;
let systemAddDateTimeframe = 10;
let docsFromExternalTimeframe = 7;
let docsToExternalTimeframe = 7;
let docsToLocalTimeframe = 2;

let fundName;
let internalId;
let externalId;

let amlKycCompleteDate;
let systemAddDoneDate;
let docsDueFromExternalDate;
let docsToExternalDate;
let docsToLocalDate;

/* START MODAL OPENING AND CLOSING */
const openModalButtons = document.querySelectorAll("[data-modal-target]");
const closeModalButtons = document.querySelectorAll("[data-close-button]");
const overlay = document.getElementById("overlay");

openModalButtons.forEach((button) => {
  button.addEventListener("click", () => {
    const modal = document.querySelector(button.dataset.modalTarget);
    openModal(modal);
  });
});

overlay.addEventListener("click", () => {
  const modals = document.querySelectorAll(".modal.active");
  modals.forEach((modal) => {
    closeModal(modal);
  });
});

closeModalButtons.forEach((button) => {
  button.addEventListener("click", () => {
    const modal = button.closest(".modal");
    closeModal(modal);
  });
});

function openModal(modal) {
  if (modal == null) return;
  modal.classList.add("active");
  overlay.classList.add("active");
}

function closeModal(modal) {
  if (modal == null) return;
  modal.classList.remove("active");
  overlay.classList.remove("active");
}
/* END MODAL OPENING AND CLOSING */

/* START ADD MARKETS AND RADIO BUTTONS TO MODAL */
// On load calls populateMarketsToChooseFrom function
window.addEventListener("load", function () {
  this.populateMarketsToChooseFrom();
});

// Populate market list from marketsData
function populateMarketsToChooseFrom() {
  for (let i = 0; i < marketsData.length; i++) {
    let market = marketsData[i]["marketId"];
    let markets = document.getElementById("marketsList");
    let marketDiv = document.createElement("div");
    let marketName = document.createElement("p");
    marketName.appendChild(
      document.createTextNode(marketsData[i]["name"] + ":")
    );
    let radioDayOne = document.createElement("input");
    radioDayOne.type = "radio";
    radioDayOne.name = market;
    radioDayOne.value = "Day One";
    radioDayOne.id = `${market}RadioDayOneId`;
    let radioAsap = document.createElement("input");
    radioAsap.type = "radio";
    radioAsap.name = market;
    radioAsap.value = "ASAP";
    radioAsap.id = `${market}RadioAsapId`;
    let radioNotRequired = document.createElement("input");
    radioNotRequired.type = "radio";
    radioNotRequired.name = market;
    radioNotRequired.value = "Not Required";
    radioNotRequired.id = `${market}RadioNotRequiredId`;

    let labelDayOne = document.createElement("label");
    labelDayOne.htmlFor = `${market}RadioDayOneId`;
    labelDayOne.appendChild(document.createTextNode("Day One"));
    let labelAsap = document.createElement("label");
    labelAsap.htmlFor = `${market}RadioAsapId`;
    labelAsap.appendChild(document.createTextNode("ASAP"));
    let labelNotRequired = document.createElement("label");
    labelNotRequired.htmlFor = `${market}RSadioNotRequiredId`;
    labelNotRequired.appendChild(document.createTextNode("Not Required"));

    markets.appendChild(marketDiv);
    marketDiv.appendChild(marketName);
    marketDiv.appendChild(radioDayOne);
    marketDiv.appendChild(labelDayOne);
    marketDiv.appendChild(radioAsap);
    marketDiv.appendChild(labelAsap);
    marketDiv.appendChild(radioNotRequired);
    marketDiv.appendChild(labelNotRequired);
  }
}
/* END ADD MARKETS AND RADIO BUTTONS TO MODAL */

/* START UPDATING MARKET REQUESTED STATUS BASED ON SELECTED RADIO BUTTON */
function updateRequestedStatus() {
  console.log("updating requested status");
  for (let i = 0; i < marketsData.length; i++) {
    console.log("looping through markets");
    let marketId = marketsData[i]["marketId"];
    // let
    // console.log(`${marketId}RadioDayOne`);
    if (document.getElementById(`${marketId}RadioDayOneId`).checked) {
      console.log("radio day one is checked");
      marketsData[i]["requestedAsap"] = "No";
      marketsData[i]["requestedDay1"] = "Yes";
    } else if (document.getElementById(`${marketId}RadioAsapId`).checked) {
      console.log("asap is checked");
      marketsData[i]["requestedAsap"] = "Yes";
      marketsData[i]["requestedDay1"] = "No";
    } else if (
      document.getElementById(`${marketId}RadioNotRequiredId`).checked
    ) {
      console.log("not required");
      marketsData[i]["requestedDay1"] = "No";
      marketsData[i]["requestedAsap"] = "No";
    } else {
      console.log("nothing is checked");
      marketsData[i]["requestedDay1"] = "No";
      marketsData[i]["requestedAsap"] = "No";
    }
  }
}
/* END UPDATING MARKET REQUESTED STATUS BASED ON SELECTED RADIO BUTTON */

/* START CHECK FOR DAY 1 NON DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */
function checkDayOneNonDoc(requested) {
  console.log("checking day one non doc");
  return requested["requestedDay1"] == "No";
}
function checkforDayOneNonDoc() {
  let result = marketsData.filter((market) => market["docMarket"] == "No");
  // console.log(result);
  if (result.every(checkDayOneNonDoc)) {
    console.log("no day one non doc markets requested");
  } else {
    console.log("someone picked a day one non doc market");
    updateNonDocDayOneMarketTables();
  }
}
/* END CHECK FOR DAY 1 NON DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */

/* START CHECK FOR DAY 1 DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */
function checkDayOneDoc(requested) {
  console.log("checking day one doc markets");
  return requested["requestedDay1"] == "No";
}
function checkforDayOneDoc() {
  let result = marketsData.filter((market) => market["docMarket"] == "Yes");
  // console.log("result is: " + result);
  if (result.every(checkDayOneDoc)) {
    console.log("no day one doc markets requested");
  } else {
    console.log("someone picked a day one doc market");
    updateDocDayOneMarketTables();
  }
}
/* END CHECK FOR DAY 1 DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */

/* START CHECK FOR ASAP NON DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */
function checkAsapNonDoc(requested) {
  console.log("checking asap non doc");
  return requested["requestedAsap"] == "No";
}
function checkforAsapNonDoc() {
  let result = marketsData.filter((market) => market["docMarket"] == "No");
  // console.log("result is: " + result);
  if (result.every(checkAsapNonDoc)) {
    console.log("no asap non doc markets requested");
  } else {
    console.log("someone picked an asap non doc market");
    updateNonDocAsapMarketTables();
  }
}
/* END CHECK FOR ASAP NON DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */

/* START CHECK FOR ASAP DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */
function checkAsapDoc(requested) {
  console.log("checking asap doc markets");
  return requested["requestedAsap"] == "No";
}
function checkforAsapDoc() {
  let result = marketsData.filter((market) => market["docMarket"] == "Yes");
  // console.log("result is: " + result);
  if (result.every(checkAsapDoc)) {
    console.log("no asap doc markets requested");
  } else {
    console.log("someone picked an asap doc market");
    updateDocAsapMarketTables();
  }
}
/* END CHECK FOR ASAP NON DOC SELECTED. IF NONE SELECTED,DO NOT CREATE DAY 1 NON DOC TABLE OR REMOVE EXISTING DAY 1 NON DOC TABLE. IF ANY DAY 1 NON DOC IS YES, THEN CREATE OR UPDATE DAY ONE NON DOC TABLE */

/*  START REMOVE NON DOC DAY 1 MARKETS TABLES */
function removeNonDocDayOneMarketsTables() {
  console.log("removing non doc day one markets tables");
  let elementExists = document.getElementById("table1header");
  console.log(elementExists);
  if (elementExists) {
    console.log("table1header exists");
    let elem = document.getElementById("table1header");
    elem.parentNode.removeChild(elem);
    let elem1 = document.getElementById("t1bodyid");
    elem1.parentNode.removeChild(elem1);
  } else {
    console.log("table1header does not exist");
  }
}
/*  END REMOVE NON DOC DAY 1 MARKETS TABLES */

/*  START REMOVE DOC DAY 1 MARKETS TABLES */
function removeDocDayOneMarketsTables() {
  console.log("removing doc day one markets tables");
  let elementExists = document.getElementById("table2header");
  console.log(elementExists);
  if (elementExists) {
    console.log("table2header exists");
    let elem = document.getElementById("table2header");
    elem.parentNode.removeChild(elem);
    let elem1 = document.getElementById("t2bodyid");
    elem1.parentNode.removeChild(elem1);
  } else {
    console.log("table2header does not exist");
  }
}
/*  END REMOVE DOC DAY 1 MARKETS TABLES */

/*  START REMOVE NON DOC ASAP MARKETS TABLES */
function removeNonDocAsapMarketsTables() {
  console.log("removing non doc asap markets tables");
  let elementExists = document.getElementById("table3header");
  console.log(elementExists);
  if (elementExists) {
    console.log("table3header exists");
    let elem = document.getElementById("table3header");
    elem.parentNode.removeChild(elem);
    let elem1 = document.getElementById("t3bodyid");
    elem1.parentNode.removeChild(elem1);
  } else {
    console.log("table3header does not exist");
  }
}
/*  END REMOVE NON DOC ASAP MARKETS TABLES */

/*  START REMOVE DOC ASAP MARKETS TABLES */
function removeDocAsapMarketsTables() {
  console.log("removing doc asap markets tables");
  let elementExists = document.getElementById("table4header");
  console.log(elementExists);
  if (elementExists) {
    console.log("table4header exists");
    let elem = document.getElementById("table4header");
    elem.parentNode.removeChild(elem);
    let elem1 = document.getElementById("t4bodyid");
    elem1.parentNode.removeChild(elem1);
  } else {
    console.log("table4header does not exist");
  }
}
/*  END REMOVE DOC ASAP MARKETS TABLES */

/* START CREATE NON DOC DAY 1 MARKETS TABLE */
function updateNonDocDayOneMarketTables() {
  console.log("updating non doc day 1 market tables");
  let table = document.querySelector("#table1");
<<<<<<< HEAD
  let data = ["Day One Non Doc Markets", "Days to Open", "Open Date"];
=======
  let data = ["Market", "Days to Open", "Open Date"];
>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
  console.log(data);
  generateTable(table, marketsData); // generate the table first
  generateTableHead(table, data); // then the head
  let tbody = table.querySelector("tbody");
  tbody.classList.add("tbodyClass");
  tbody.setAttribute("id", "t1bodyid");
}

// Creates the table header
function generateTableHead(table, data) {
  //console.log("generateTableHead is called");
  let thead = table.createTHead();
  let row = thead.insertRow();
  thead.setAttribute("id", "table1header");
  for (let key of data) {
    let th = document.createElement("th");
    let text = document.createTextNode(key);
    th.appendChild(text);
    row.appendChild(th);
  }
  //console.log("generateTableHead success");
}

// Creates the table body
function generateTable(table, data) {
  //console.log("generateTable is called");
  for (let element of data) {
    if (element["requestedDay1"] == "Yes" && element["docMarket"] == "No") {
      //  console.log("element: " + element["name"]);
      let row = table.insertRow();
      let cell = row.insertCell();
      let cell2 = row.insertCell();
      let cell3 = row.insertCell();
      let text = document.createTextNode(element["name"]);
      let text2 = document.createTextNode(element["timeframeToOpen"]);
      let text3 = document.createTextNode(element["openDate"]);
      cell.appendChild(text);
      cell2.appendChild(text2);
      cell3.appendChild(text3);
      cell3.setAttribute("class", "openDateCell");
<<<<<<< HEAD
=======

>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
    }
  }
  //console.log("generateTable success");
}
/* END CREATE NON DOC DAY 1 MARKETS TABLE */

/* START CREATE DOC DAY 1 MARKETS TABLE */
function updateDocDayOneMarketTables() {
  console.log("updating doc day 1 market tables");
  let table = document.querySelector("#table2");
<<<<<<< HEAD
  let data = ["Day One Doc Markets", "Days to Open", "Open Date"];
=======
  let data = ["Market", "Days to Open", "Open Date"];
>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
  console.log(data);
  generateTable2(table, marketsData); // generate the table first
  generateTable2Head(table, data); // then the head
  let tbody = table.querySelector("tbody");
  tbody.classList.add("tbodyClass");
  tbody.setAttribute("id", "t2bodyid");
}

// Creates the table header
function generateTable2Head(table, data) {
  console.log("generateTable2Head is running");
  let thead = table.createTHead();
  let row = thead.insertRow();
  thead.setAttribute("id", "table2header");
  for (let key of data) {
    let th = document.createElement("th");
    let text = document.createTextNode(key);
    th.appendChild(text);
    row.appendChild(th);
  }
  console.log("generateTable2Head success");
}

// Creates the table body
function generateTable2(table, data) {
  console.log("generateTable2 is running");
  for (let element of data) {
    if (element["requestedDay1"] == "Yes" && element["docMarket"] == "Yes") {
      console.log("element: " + element["name"]);
      let row = table.insertRow();
      let cell = row.insertCell();
      let cell2 = row.insertCell();
      let cell3 = row.insertCell();
      let text = document.createTextNode(element["name"]);
      let text2 = document.createTextNode(element["timeframeToOpen"]);
      let text3 = document.createTextNode(element["openDate"]);
      cell.appendChild(text);
      cell2.appendChild(text2);
      cell3.appendChild(text3);
      cell3.setAttribute("class", "openDateCell");
<<<<<<< HEAD
=======

>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
    }
  }
  console.log("generateTable2 success");
}
/* END CREATE DOC DAY 1 MARKETS TABLE */

/* START CREATE NON DOC ASAP MARKETS TABLE */
function updateNonDocAsapMarketTables() {
  console.log("updating non doc asap market tables");
  let table = document.querySelector("#table3");
<<<<<<< HEAD
  let data = ["ASAP Non Doc Markets", "Days to Open", "Open Date"];
=======
  let data = ["Market", "Days to Open", "Open Date"];
>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
  console.log(data);
  generateTable3(table, marketsData); // generate the table first
  generateTable3Head(table, data); // then the head
  let tbody = table.querySelector("tbody");
  tbody.classList.add("tbodyClass");
  tbody.setAttribute("id", "t3bodyid");
}

// Creates the table header
function generateTable3Head(table, data) {
  console.log("generateTable3Head is called");
  let thead = table.createTHead();
  let row = thead.insertRow();
  thead.setAttribute("id", "table3header");
  for (let key of data) {
    let th = document.createElement("th");
    let text = document.createTextNode(key);
    th.appendChild(text);
    row.appendChild(th);
  }
  console.log("generateTable3Head success");
}

// Creates the table body
function generateTable3(table, data) {
  console.log("generateTable3 is running");
  for (let element of data) {
    if (element["requestedAsap"] == "Yes" && element["docMarket"] == "No") {
      console.log("element: " + element["name"]);
      let row = table.insertRow();
      let cell = row.insertCell();
      let cell2 = row.insertCell();
      let cell3 = row.insertCell();
      let text = document.createTextNode(element["name"]);
      let text2 = document.createTextNode(element["timeframeToOpen"]);
      let text3 = document.createTextNode(element["openDate"]);
      cell.appendChild(text);
      cell2.appendChild(text2);
      cell3.appendChild(text3);
      cell3.setAttribute("class", "openDateCell");
<<<<<<< HEAD
=======

>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
    }
  }
  console.log("generateTable3 success");
}
/* END CREATE NON DOC ASAP MARKETS TABLE */

/* START CREATE DOC ASAP MARKETS TABLE */
function updateDocAsapMarketTables() {
  console.log("updating doc asap markets");
  let table = document.querySelector("#table4");
<<<<<<< HEAD
  let data = ["ASAP Doc Markets", "Days to Open", "Open Date"];
=======
  let data = ["Market", "Days to Open", "Open Date"];
>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
  console.log(data);
  generateTable4(table, marketsData); // generate the table first
  generateTable4Head(table, data); // then the head
  let tbody = table.querySelector("tbody");
  tbody.classList.add("tbodyClass");
  tbody.setAttribute("id", "t4bodyid");
}

// Creates the table header
function generateTable4Head(table, data) {
  console.log("generateTable4Head is running");
  let thead = table.createTHead();
  let row = thead.insertRow();
  thead.setAttribute("id", "table4header");
  for (let key of data) {
    let th = document.createElement("th");
    let text = document.createTextNode(key);
    th.appendChild(text);
    row.appendChild(th);
  }
  console.log("generateTable4Head success");
}

// Creates the table body
function generateTable4(table, data) {
  console.log("generateTable4 is running");
  for (let element of data) {
    if (element["requestedAsap"] == "Yes" && element["docMarket"] == "Yes") {
      console.log("element: " + element["name"]);
      let row = table.insertRow();
      let cell = row.insertCell();
      let cell2 = row.insertCell();
      let cell3 = row.insertCell();
      let text = document.createTextNode(element["name"]);
      let text2 = document.createTextNode(element["timeframeToOpen"]);
      let text3 = document.createTextNode(element["openDate"]);
      cell.appendChild(text);
      cell2.appendChild(text2);
      cell3.appendChild(text3);
      cell3.setAttribute("class", "openDateCell");
    }
  }
  console.log("generateTable4 success");
}
/* END CREATE DOC ASAP MARKETS TABLE */

/* SUBMIT FUND DETAILS */
function submitFundDetails() {
  console.log("submitting fund details");
  fundName = document.getElementById("fname").value;
  internalId = document.getElementById("internalId").value;
  externalId = document.getElementById("externalId").value;
  launchDate = document.getElementById("launchdate").value;
  amlKycSubmitDate = document.getElementById("amldate").value;
  updateOpenDate();
  updateSlaDates();
}
/* END FUND DETAILS */

/* START UPDATE OPEN DATE FOR EACH MARKET */
function updateOpenDate() {
  console.log("updating open dates");
  for (let i = 0; i < marketsData.length; i++) {
    console.log(marketsData[i]["timeframeToOpen"]);
    let totalTimeToOpen =
      amlKycCompleteDateTimeframe +
      systemAddDateTimeframe +
      docsFromExternalTimeframe +
      docsToExternalTimeframe +
      docsToLocalTimeframe +
      marketsData[i]["timeframeToOpen"];
    console.log(totalTimeToOpen);
    marketsData[i]["openDate"] = convertInDateToCompletionDate(
      totalTimeToOpen,
      amlKycSubmitDate
    );
    console.log(marketsData[i]["openDate"]);
  }
}
/* END UPDATE OPEN DATE FOR EACH MARKET */

/* START UPDATE SLA DATES */
function updateSlaDates() {
  console.log("updating SLA dates");
  amlKycCompleteDate = convertInDateToCompletionDate(
    amlKycCompleteDateTimeframe,
    amlKycSubmitDate
  );
  systemAddDoneDate = convertInDateToCompletionDate(
    systemAddDateTimeframe,
    amlKycCompleteDate
  );
  docsDueFromExternalDate = convertInDateToCompletionDate(
    docsFromExternalTimeframe,
    systemAddDoneDate
  );
  docsToExternalDate = convertInDateToCompletionDate(
    docsToExternalTimeframe,
    docsDueFromExternalDate
  );
  docsToLocalDate = convertInDateToCompletionDate(
    docsToLocalTimeframe,
    docsToExternalDate
  );

  document.getElementById(
    "amlKycCompleteDateCell"
  ).innerHTML = amlKycCompleteDate;
  document.getElementById(
    "systemAddDoneDateCell"
  ).innerHTML = systemAddDoneDate;
  document.getElementById(
    "docsDueFromSscDateCell"
  ).innerHTML = docsDueFromExternalDate;
  document.getElementById(
    "docsDueToSscDateCell"
  ).innerHTML = docsToExternalDate;
  document.getElementById("sscToLocalDateCell").innerHTML = docsToLocalDate;
}
/* END UPDATE SLA DATES */

/* START FUNCTION TO ADD X NUMBER OF BUSINESS DAYS TO A GIVEN DATE */
// The idea was to start with the business days and count backwards to zero for each day encountered that fell in to the range of a business day.
//This use of switch would enable a person to declare a day in the week as a non-business day, for example someone may not work on a monday, therefore the addition of case:1 would include a monday.
// This is a simple script and does not take in to account public or bank holidays, that would be asking for a much more complex script to work with.
// The result is a date that is set to the date of shipping, the user can then extract the date info in any format that they please, eg.
function convertInDateToCompletionDate(numberOfBusinessDaysToAdd, beginDateIn) {
  let businessDays = numberOfBusinessDaysToAdd,
    counter = 1; // set to 1 to count from next business day
  let endDateOut;
  while (businessDays > 0) {
    let tmp = new Date(beginDateIn.replace(/-/g, "/"));
    let startDate = new Date(beginDateIn.replace(/-/g, "/"));
    tmp.setDate(startDate.getDate() + counter++);
    switch (tmp.getDay()) {
      case 0:
      case 6:
        break; // sunday & saturday
      default:
        businessDays--;
    }
    endDateOut = tmp.toUTCString().slice(5, 16);
  }
  console.log(endDateOut);
  console.log(typeof endDateOut);
  return endDateOut;
}
/* END FUNCTION TO ADD X NUMBER OF BUSINESS DAYS TO A GIVEN DATE */

/* START CHANGE OPEN DATE COLOR BASED ON MARKET READINESS */
<<<<<<< HEAD
function marketReadiness() {}
/* END CHANGE OPEN DATE COLOR BASED ON MARKET READINESS */

=======
function marketReadiness() {

}
/* END CHANGE OPEN DATE COLOR BASED ON MARKET READINESS */


>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f
/* START DOWNLOAD EXCEL AND CSV BUTTONS */
let btnExportCSV = document.querySelector("#exportCSVBtn");
let btnExportXLS = document.querySelector("#exportExcelBtn");
const table1 = document.querySelector("#table1");
const table2 = document.querySelector("#table2");
const table3 = document.querySelector("#table3");
const table4 = document.querySelector("#table4");
const tables = document.querySelectorAll("tbody");
// tables[0].appendChild(tables[1].querySelectorAll("tr"));
btnExportCSV.onclick = function () {
  console.log("Export in CSV");
  exportCSV();
};

btnExportXLS.onclick = () => {
  console.log("Export in Excel");
  exportXLS();
};

function exportCSV() {
  let csvContent = [];
  for (let i = 0; i < marketsData.length; i++) {
    if (
      marketsData[i]["requestedDay1"] == "Yes" ||
      marketsData[i]["requestedAsap"] == "Yes"
    ) {
      csvContent.push(
        marketsData[i]["name"] + "," + markets[i]["openDate"] + "," + fundName
      );
    }
  }
  csvContent = encodeURI(csvContent.join("\n"));
  console.log(csvContent);

  const csvContentUrl = "data:text/csv;charset=utf-8," + csvContent;

  triggerDownload(csvContentUrl, "markets.csv");
}

function exportXLS() {
  const table1Content = table1.outerHTML.replace(/ /g, "%20");
  const table2Content = table2.outerHTML.replace(/ /g, "%20");
  const table3Content = table3.outerHTML.replace(/ /g, "%20");
  const table4Content = table4.outerHTML.replace(/ /g, "%20");
  // console.log(tableContent);
  const tableHTMLUrl =
    "data:application/vnd.ms-excel;charset=utf-8," +
    table1Content +
    table2Content +
    table3Content +
    table4Content;
  console.log(tableHTMLUrl);
  triggerDownload(tableHTMLUrl, "markets.xls");
}

function triggerDownload(url, filename) {
  const downloadLink = document.createElement("a");
  downloadLink.href = url;
  downloadLink.download = filename;
  document.body.appendChild(downloadLink);
  downloadLink.click();
}
/* END DOWNLOAD EXCEL AND CSV BUTTONS */

function setReadinessColors() {
  let openDates = document.getElementsByClassName("openDateCell");
<<<<<<< HEAD
  for (let i = 0; i < openDates.length; i++) {
    if (compareDateStrings(openDates[i].innerHTML, launchDate) == "issues") {
      openDates[i].style.backgroundColor = "lightcoral";
    } else {
      openDates[i].style.backgroundColor = "lime";
    }
  }
}

/* START CONVERT STRING DATES TO TIME */
function compareDateStrings(openDateString, launchDateString) {
  // let arrivalDateString = "24 Sep 2020";
  // let startDateString = "2020-07-16";
  let openDateArgs = [];
  let launchDateArgs = [];
  let openDateYear = parseInt(openDateString.substr(7, 4));
  let openDateMonth = convertMonthStringToInt(openDateString.substr(3, 3));
  let openDateDay = parseInt(openDateString.substr(0, 2));
  let launchDateYear = parseInt(launchDateString.substr(0, 4));
  let launchDateMonth = parseInt(launchDateString.substr(5, 2));
  let launchDateDay = parseInt(launchDateString.substr(8, 2));

  openDateArgs[0] = openDateYear;
  openDateArgs[1] = openDateMonth;
  openDateArgs[2] = openDateDay;
  launchDateArgs[0] = launchDateYear;
  launchDateArgs[1] = launchDateMonth;
  launchDateArgs[2] = launchDateDay;

  let openDateObject = new Date(
    openDateArgs[0],
    openDateArgs[1],
    openDateArgs[2]
  );
  let launchDateObject = new Date(
    launchDateArgs[0],
    launchDateArgs[1],
    launchDateArgs[2]
  );
  let openTime = openDateObject.getTime();
  let launchTime = launchDateObject.getTime();

  if (openTime > launchTime) {
    return "issues";
  } else {
    return "noConcerns";
  }

  function convertMonthStringToInt(monthString) {
    let monthInt;
    if (monthString == "Jan") {
      monthInt = 0;
    } else if (monthString == "Feb") {
      monthInt = 1;
    } else if (monthString == "Mar") {
      monthInt = 2;
    } else if (monthString == "Apr") {
      monthInt = 3;
    } else if (monthString == "May") {
      monthInt = 4;
    } else if (monthString == "Jun") {
      monthInt = 5;
    } else if (monthString == "Jul") {
      monthInt = 6;
    } else if (monthString == "Aug") {
      monthInt = 7;
    } else if (monthString == "Sep") {
      monthInt = 8;
    } else if (monthString == "Oct") {
      monthInt = 9;
    } else if (monthString == "Nov") {
      monthInt = 10;
    } else if (monthString == "Dec") {
      monthInt = 11;
    }
    // console.log(monthInt);
    return monthInt + 1;
  }
}
/* END CONVERT STRING DATES TO TIME */

// document.onload = alert("Browsers other than Chrome are not supported");
=======
  for(let i = 0; i < openDates.length; i++) {
    if(compareDateStrings(openDates[i].innerHTML, launchDate) == "issues") {
      openDates[i].style.backgroundColor = "red";
    } else {
      openDates[i].style.backgroundColor = "lime";
    }
 }}

/* START CONVERT STRING DATES TO TIME */
function compareDateStrings(openDateString, launchDateString) {
// let arrivalDateString = "24 Sep 2020";
// let startDateString = "2020-07-16";
let openDateArgs = [];
let launchDateArgs = [];
let openDateYear = parseInt(openDateString.substr(7, 4));
let openDateMonth = convertMonthStringToInt(openDateString.substr(3, 3));
let openDateDay = parseInt(openDateString.substr(0, 2));
let launchDateYear = parseInt(launchDateString.substr(0, 4));
let launchDateMonth = parseInt(launchDateString.substr(5, 2));
let launchDateDay = parseInt(launchDateString.substr(8, 2));

openDateArgs[0] = openDateYear;
openDateArgs[1] = openDateMonth;
openDateArgs[2] = openDateDay;
launchDateArgs[0] = launchDateYear;
launchDateArgs[1] = launchDateMonth;
launchDateArgs[2] = launchDateDay;

let openDateObject = new Date(openDateArgs[0], openDateArgs[1], openDateArgs[2]);
let launchDateObject = new Date(launchDateArgs[0], launchDateArgs[1], launchDateArgs[2]);
let openTime = openDateObject.getTime();
let launchTime = launchDateObject.getTime();

if(openTime > launchTime) {
  return "issues"
} else {
  return "noConcerns"
}

function convertMonthStringToInt(monthString) {
  let monthInt;
  if (monthString == "Jan") {
    monthInt = 0;
  } else if (monthString == "Feb") {
    monthInt = 1;
  } else if (monthString == "Mar") {
    monthInt = 2;
  } else if (monthString == "Apr") {
    monthInt = 3;
  } else if (monthString == "May") {
    monthInt = 4;
  } else if (monthString == "Jun") {
    monthInt = 5;
  } else if (monthString == "Jul") {
    monthInt = 6;
  } else if (monthString == "Aug") {
    monthInt = 7;
  } else if (monthString == "Sep") {
    monthInt = 8;
  } else if (monthString == "Oct") {
    monthInt = 9;
  } else if (monthString == "Nov") {
    monthInt = 10;
  } else if (monthString == "Dec") {
    monthInt = 11;
  }
  // console.log(monthInt);
  return monthInt+1;
}
}
/* END CONVERT STRING DATES TO TIME */

document.onload = alert("Browsers other than Chrome are not supported")

>>>>>>> 942847a53406d65f73ee70286fc8cc4fd9b49b2f

// CHANGE THE BACKGROUND OF AN LI ELEMENT ONCLICK
//market.classList.add("type");
// market.onclick = function() {
//   console.log(this.className)
//   if (this.className == "unselected") {
//     this.classList.remove("unselected")
//     this.classList.add("selected")
//   } else if (this.className == "selected") {
//     this.classList.remove("selected")
//     this.classList.add("unselected")
//   }
// }
//market.innerText = marketsData[i].name;
//markets.appendChild(market);
